<!DOCTYPE html>
<html>
<head>
    <title>Test Question Generation Fix</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        button { padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #45a049; }
        .result { margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 4px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e9; color: #2e7d32; }
        label { display: block; margin: 10px 0; }
        input[type="checkbox"] { margin-right: 8px; }
        h3 { color: #333; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h3>üîß Test Question Generation Fix</h3>
        
        <p><strong>This tests if the checkbox selector is working correctly.</strong></p>
        
        <div style="margin: 20px 0;">
            <h4>Question Types:</h4>
            <label><input type="checkbox" class="question-type" value="mcq" checked> Multiple Choice</label>
            <label><input type="checkbox" class="question-type" value="true_false"> True/False</label>
            <label><input type="checkbox" class="question-type" value="short_answer" checked> Short Answer</label>
            <label><input type="checkbox" class="question-type" value="long_answer"> Long Answer</label>
        </div>
        
        <div style="margin: 20px 0;">
            <h4>Difficulty (Should NOT be included):</h4>
            <label><input type="checkbox" class="difficulty-level" value="easy" checked> Easy</label>
            <label><input type="checkbox" class="difficulty-level" value="medium" checked> Medium</label>
            <label><input type="checkbox" class="difficulty-level" value="hard" checked> Hard</label>
        </div>
        
        <button onclick="testSelector()">Test Selector</button>
        
        <div id="result" class="result" style="display: none;"></div>
    </div>
    
    <script>
        function testSelector() {
            // OLD WAY (WRONG - picks up everything)
            const oldWay = Array.from(document.querySelectorAll('.checkbox-group input:checked'))
                .map(cb => cb.value);
            
            // NEW WAY (CORRECT - only question types)
            const newWay = Array.from(document.querySelectorAll('.question-type:checked'))
                .map(cb => cb.value);
            
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            let html = '<h4>Results:</h4>';
            
            // Check if old way had the bug
            const hasBug = oldWay.some(v => ['easy', 'medium', 'hard'].includes(v));
            
            if (hasBug) {
                resultDiv.className = 'result error';
                html += '<p><strong>‚ùå OLD WAY (BUG):</strong></p>';
                html += '<p>Selected: ' + JSON.stringify(oldWay) + '</p>';
                html += '<p>‚ö†Ô∏è This includes difficulty values which causes 422 error!</p>';
            } else {
                html += '<p><strong>OLD WAY:</strong> ' + JSON.stringify(oldWay) + '</p>';
            }
            
            html += '<hr>';
            html += '<p><strong>‚úÖ NEW WAY (FIXED):</strong></p>';
            html += '<p>Selected: ' + JSON.stringify(newWay) + '</p>';
            
            // Validate
            const validTypes = ['mcq', 'true_false', 'short_answer', 'long_answer', 'fill_blank', 'programming'];
            const allValid = newWay.every(v => validTypes.includes(v));
            
            if (allValid && newWay.length > 0) {
                resultDiv.className = 'result success';
                html += '<p><strong>‚úÖ All values are valid question types!</strong></p>';
                html += '<p>This will work with the backend!</p>';
            } else if (newWay.length === 0) {
                html += '<p><strong>‚ö†Ô∏è No question types selected</strong></p>';
            } else {
                resultDiv.className = 'result error';
                html += '<p><strong>‚ùå Invalid values detected!</strong></p>';
            }
            
            resultDiv.innerHTML = html;
        }
        
        // Auto-test on load
        window.onload = () => {
            setTimeout(testSelector, 500);
        };
    </script>
</body>
</html>
